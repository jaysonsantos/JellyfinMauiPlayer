<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
  xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
  xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
  xmlns:viewmodels="clr-namespace:Player.ViewModels"
  xmlns:converters="clr-namespace:Player.Converters"
  xmlns:strings="clr-namespace:Player.Resources.Strings"
  x:Class="Player.Pages.LoginPage"
  x:DataType="viewmodels:LoginViewModel"
  Title="{x:Static strings:AppResources.LoginPage_Title}"
>
  <ContentPage.Resources>
    <ResourceDictionary>
      <converters:InvertedBoolConverter x:Key="InvertedBoolConverter" />
      <converters:IsStringNotNullOrEmptyConverter x:Key="IsStringNotNullOrEmptyConverter" />
    </ResourceDictionary>
  </ContentPage.Resources>

  <ScrollView>
    <VerticalStackLayout Padding="30,60,30,30" Spacing="20" VerticalOptions="Center">
      <Image
        Source="dotnet_bot.png"
        HeightRequest="100"
        Aspect="AspectFit"
        HorizontalOptions="Center"
      />

      <Label
        Text="{x:Static strings:AppResources.LoginPage_AppTitle}"
        Style="{StaticResource Headline}"
        HorizontalOptions="Center"
        SemanticProperties.HeadingLevel="Level1"
      />

      <Label
        Text="{x:Static strings:AppResources.LoginPage_Subtitle}"
        Style="{StaticResource SubHeadline}"
        HorizontalOptions="Center"
        SemanticProperties.HeadingLevel="Level2"
      />

      <!-- Server URL -->
      <VerticalStackLayout Spacing="5">
        <Label Text="{x:Static strings:AppResources.LoginPage_ServerUrlLabel}" />
        <Entry
          Text="{Binding ServerUrl}"
          Placeholder="{x:Static strings:AppResources.LoginPage_ServerUrlPlaceholder}"
          Keyboard="Url"
          IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
        />
      </VerticalStackLayout>

      <!-- Username -->
      <VerticalStackLayout Spacing="5">
        <Label Text="{x:Static strings:AppResources.LoginPage_UsernameLabel}" />
        <Entry
          Text="{Binding Username}"
          Placeholder="{x:Static strings:AppResources.LoginPage_UsernamePlaceholder}"
          IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
        />
      </VerticalStackLayout>

      <!-- Password -->
      <VerticalStackLayout Spacing="5">
        <Label Text="{x:Static strings:AppResources.LoginPage_PasswordLabel}" />
        <Entry
          Text="{Binding Password}"
          Placeholder="{x:Static strings:AppResources.LoginPage_PasswordPlaceholder}"
          IsPassword="True"
          IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
        />
      </VerticalStackLayout>

      <!-- Error Message -->
      <Label
        Text="{Binding ErrorMessage}"
        TextColor="{DynamicResource ErrorColor}"
        IsVisible="{Binding ErrorMessage, Converter={StaticResource IsStringNotNullOrEmptyConverter}}"
        FontSize="14"
      />

      <!-- Login Button -->
      <Button
        Text="{x:Static strings:AppResources.LoginPage_LoginButton}"
        Command="{Binding LoginCommand}"
        IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
        HorizontalOptions="Fill"
      />

      <!-- Loading Indicator -->
      <ActivityIndicator
        IsRunning="{Binding IsLoading}"
        IsVisible="{Binding IsLoading}"
        HeightRequest="30"
      />
    </VerticalStackLayout>
  </ScrollView>
</ContentPage>
